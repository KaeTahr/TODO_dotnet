<h1>Todos</h1>

<button (click)="openCreate()">+ Add Todo</button>
<app-create-todo (created)="handleCreated($event)"></app-create-todo>

<div class="cards">
  <article class="card" *ngFor="let t of todos" (click)="open(t)">
    <header>
      <h3>{{ t.title }}</h3>
      <span class="badge" [class.todo]="t.status==='Todo'" [class.progress]="t.status==='InProgress'" [class.done]="t.status==='Done'">
        {{ t.status }}
      </span>
    </header>
    <p class="desc">{{ t.description || 'No description' }}</p>
    <footer (click)="$event.stopPropagation()">
      <small>Author: {{t.author || '—'}} · Assigned: {{t.assignedTo || '—'}}</small>
      <div class="actions">
        <button class="green" (click)="markDone(t)">Complete</button>
        <button class="red" (click)="confirmDelete(t)">Delete</button>
      </div>
    </footer>
  </article>
</div>


<dialog #detailDialog>
  <ng-container *ngIf="selected as s">
    <h2>{{ s.title }}</h2>

    <label>Description</label>
    <textarea [(ngModel)]="s.description"></textarea>

    <label>Assigned to</label>
    <select [(ngModel)]="s.assignedTo">
      <option *ngFor="let u of users" [value]="u">{{u}}</option>
    </select>

    <label>Status</label>
    <select [(ngModel)]="s.status">
      <option value="Todo">Todo</option>
      <option value="InProgress">InProgress</option>
      <option value="Done">Done</option>
    </select>

    <div class="modal-actions">
      <button (click)="save()">Save</button>
      <button (click)="close()">Close</button>
    </div>
  </ng-container>
</dialog>